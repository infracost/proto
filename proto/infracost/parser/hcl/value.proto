syntax = "proto3";

package infracost.parser.hcl;

import "infracost/parser/expectation.proto";
import "infracost/parser/metadata.proto";

message Value {
  oneof value {
    PrimitiveValue primitive = 1;
    ListValue list = 2;
    MapValue map = 3;
    NullValue null = 4;
  }
  parser.SourceRange source_range = 5;
  uint64 flags = 6;
}

message PrimitiveValue {
  oneof value {
    string string_value = 1;
    string number_value = 2; // big.Float as string
    bool bool_value = 3;
  }
  uint32 primitive_type = 4; // primitiveType enum
}

message ListValue {
  repeated Value values = 1;
  optional parser.Expectation element_type = 2; // cty.Type as string
  bool is_tuple = 3;
  bool is_set = 4;
}

message MapValue {
  repeated MapEntry entries = 1;
  bool is_object = 2;
}

message MapEntry {
  string key = 1;
  Value value = 2;
  parser.SourceRange key_source_range = 3;
  uint64 key_flags = 4;
}

message NullValue {
  // Empty - null values only need metadata which is in parent
}
